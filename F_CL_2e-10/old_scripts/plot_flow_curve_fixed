#!/usr/bin/python
import os
import numpy as np
import pandas as pd
import matplotlib as mpl
mpl.use('Agg')
import matplotlib.pyplot as plt
# Font management -------------------------------
plt.rcParams['text.latex.preamble']=[r"\usepackage{lmodern}"]
#Options
params = {'text.usetex' : True,
          'font.size' : 14,
          'font.family' : 'lmodern',
          'text.latex.unicode': True,
          }
plt.rcParams.update(params)
#-----------------------------------------------
savepath = "/var/scratch/vsivadas/suspension_simulation/spheres_poly_rhor1/F_CL_model_test_corrected/F_CL_2e-10/manuscipt_paper_scripts/"
def get_nu_mean_std(path):
    db = pd.read_csv(path)
    nu = db[db.columns[4]][:].values
    return np.mean(nu), np.std(nu)

phivals = [40,45,50,54,55,56]
ydvals = [float(i) for i in range(10000)]
paths_temp = ["rhor1_phi{}_yd{}".format(i,j) for i in phivals for j in ydvals ]
paths = []
for i in paths_temp:
    if os.path.exists(i+"/result/nu_t.dat"):
        paths.append(i+"/result/nu_t.dat")
#print paths
plt.figure(dpi=500)
for phi in phivals:
    yd_list,nu_mean_list, nu_std_list = [],[],[]
    for yd in ydvals:
        path = "rhor1_phi{}_yd{}".format(phi,yd)+"/result/nu_t.dat"
        if os.path.exists(path):
            #print path
            nu_mean,nu_std = get_nu_mean_std(path)
            yd_list.append(yd)
            nu_mean_list.append(nu_mean)
            nu_std_list.append(nu_std)
    plt.errorbar(yd_list, nu_mean_list, yerr=nu_std_list, label="$\phi=${}".format(phi/100.0),fmt="o-",elinewidth=0.5,capthick=0.5,capsize=5,linewidth=3,)

plt.legend(loc="best", frameon=False)
plt.xlabel("shear rate $\dot{\gamma}$ (1/s)")
plt.ylabel("relative viscosity $\eta_{r}$")
plt.xscale("log")
plt.yscale("log")
plt.savefig(savepath+"flowcurve_yd_vs_nu_rel_errrorbars")
